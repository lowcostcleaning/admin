<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lowcost Cleaning ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
  <style>
    :root {
      --bg-light:#f8f8f8;
      --text-primary:#111;
      --text-muted:#666;
      --radius:14px;
      --shadow-soft:0 8px 20px rgba(0,0,0,0.06);
    }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",Roboto,sans-serif;
      background:var(--bg-light);
      color:var(--text-primary);
      margin:0;
      padding:0;
      text-align:center;
    }
    header{padding:60px 20px 40px;}
    h1{margin:0;font-size:2rem;}
    p{color:var(--text-muted);margin:10px 0 30px;}
    table{width:95%;max-width:800px;margin:20px auto;border-collapse:collapse;background:#fff;
          border-radius:14px;box-shadow:var(--shadow-soft);overflow:hidden;}
    th,td{padding:12px 10px;border-bottom:1px solid #eee;}
    th{background:#f2f2f2;}
    tr:last-child td{border-bottom:none;}
    .status{padding:6px 12px;border-radius:10px;font-weight:500;}
    .free{background:rgba(52,199,89,0.15);color:#2b8a3e;}
    .busy{background:rgba(255,59,48,0.15);color:#d22;}
    .waiting{background:rgba(255,204,0,0.2);color:#b58d00;}
    .refused{background:rgba(0,122,255,0.15);color:#004a9f;}
    #logoutBtn{
      position:fixed;top:20px;right:20px;padding:10px 16px;border:none;
      background:#000;color:#fff;border-radius:10px;cursor:pointer;
      font-size:.9rem;box-shadow:var(--shadow-soft);
    }
  </style>
</head>
<body>

<header>
  <h1>üßπ Lowcost Cleaning</h1>
  <p>–ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–æ–≤ (–¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets)</p>
</header>

<div id="tablesContainer">
  <p>‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
</div>

<button id="logoutBtn" style="display:none;" onclick="logout()">–í—ã–π—Ç–∏</button>

<script>
// --- üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è ---
const ACCESS_PASSWORD = "12345"; // ‚Üê –∏–∑–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å
function checkAccess() {
  const pass = localStorage.getItem("lc-access");
  if(pass === ACCESS_PASSWORD){ init(); return; }
  const entered = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞:");
  if(entered === ACCESS_PASSWORD){
    localStorage.setItem("lc-access", ACCESS_PASSWORD);
    init();
  } else {
    document.body.innerHTML = "<h2 style='margin-top:50px;'>üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω</h2>";
  }
}
function logout(){
  localStorage.removeItem("lc-access");
  location.reload();
}

// --- üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Google Sheets ---
const BASE_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vS8zb-CjwcHeTuOYB5iT5jz5RdMPaz0_BrTT6E1jPtaXfSbh7O1xykOE5WI92idU6A-SZ2GLzdcgtMU/pub?gid=";
const gids={"–ì–ª–∞–≤–Ω—ã–π":"0","–•–∏–º—á–∏—Å—Ç–∫–∞":"591986483","–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã":"1636464154"};

async function getSheetData(gid){
  const url=`${BASE_URL}${gid}&single=true&output=csv&nocache=${Date.now()}`;
  const res=await fetch(url);
  const text=await res.text();
  const rows=text.split("\n").map(r=>r.split(",").map(c=>c.trim()));
  return rows.filter(r=>r[0]);
}

async function init(){
  document.getElementById("logoutBtn").style.display="block";
  const cont=document.getElementById("tablesContainer");
  cont.innerHTML="‚è≥ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã...";
  const allData={};
  for(const [name,gid] of Object.entries(gids)){
    allData[name]=await getSheetData(gid);
  }
  render(allData);
}

function render(allData){
  const cont=document.getElementById("tablesContainer");
  cont.innerHTML="";
  for(const [name,rows] of Object.entries(allData)){
    const table=document.createElement("table");
    const caption=document.createElement("caption");
    caption.textContent="üìã "+name;
    caption.style.fontWeight="700";
    caption.style.padding="10px";
    caption.style.fontSize="1.1rem";
    const header=document.createElement("tr");
    header.innerHTML="<th>–î–∞—Ç–∞</th><th>–°—Ç–∞—Ç—É—Å</th>";
    table.appendChild(header);

    rows.slice(1).forEach(r=>{
      const tr=document.createElement("tr");
      const date=r[0]||"";
      const status=(r[1]||"").toLowerCase();
      let cls="";let text=status;
      if(status.includes("–∑–∞–Ω—è—Ç–æ"))cls="busy";
      else if(status.includes("–æ–∂–∏–¥"))cls="waiting";
      else if(status.includes("–æ—Ç–∫–∞–∑"))cls="refused";
      else cls="free";
      tr.innerHTML=`<td>${date}</td><td><span class="status ${cls}">${text}</span></td>`;
      table.appendChild(tr);
    });
    table.prepend(caption);
    cont.appendChild(table);
  }
}

checkAccess();
</script>

</body>
</html>
